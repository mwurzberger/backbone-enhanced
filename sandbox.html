<!doctype html>
<html>
	<head>
		<meta charset="utf-8">

  		<title>Backbone Enhanced Sandbox</title>		
	</head>
	<body>
		<h1>Backbone Enhanced Sandbox</h1>
		
		<!-- <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.underscore.js"></script> -->		
		<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.underscore.js"></script>
		<!-- <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.6.0/underscore.js"></script> -->		
		<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone.js"></script>
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.11.1.js"></script>
		<script type="text/javascript" src="lib/main.js"></script>
		<script type="text/javascript">
			var GunModel = Backbone.Model.extend({
				defaults: {
					"max-clip-size": 0, 
				 	"name": "Gun Name", 
				 	"empty": true 
				},

				toString: function(){					
					return ["This ", this.getName(), " has a maximum of ", this.getMaxClipSize(), " rounds and is currently ", (this.isEmpty() ? "empty." : "loaded.")].join("");
				}			 	
			});

			var GunList = Backbone.Collection.extend({
				model: GunModel,
				initialize: function() {
					this._meta = {};
				},
				meta: function(prop, value) {
					if (value === undefined) {
						return this._meta[prop];
					} else {
						this._meta[prop] = value;
					}
				},
				toString: function(){					
					_.each( this.models, function( model ){
						console.log(model.toString());
					});
				}
			});

			var GunSafe = Backbone.Model.extend({
				defaults: {
					"contains": "Guns"
				},
				initialize: function() {
					this.guns = new GunList;
				},
				toString: function(){
					console.log("Gun safe containing " + this.getContains());
					this.guns.toString();
				}
			});

			var ppk = new GunModel({
			 	"max-clip-size": 9,
			 	"name": "Walther PPK", 
			 	"empty": false
			});

			var battleRifle = new GunModel({
			 	"max-clip-size": 15,
			 	"name": "Halo Battle Rifle", 
			 	"empty": true
			});

			var colt1911 = new GunModel({
			 	"max-clip-size": 15,
			 	"name": "Colt 1911 .45 ACP", 
			 	"empty": true
			});

			var MyGuns = new GunSafe({"contians":"all my guns"});
			var Pistols = new GunSafe({"contains":"my pistols"});

			MyGuns.guns.add([ ppk, battleRifle, colt1911]);
			Pistols.guns.add([ ppk, colt1911 ]);

			MyGuns.toString();
			Pistols.toString();

			ppk.setEmpty( true );

			MyGuns.toString();
			Pistols.toString();			
		</script>
	</body>
</html>